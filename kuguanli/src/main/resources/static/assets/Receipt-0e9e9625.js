import{B as O}from"./BgContainer-d59c353d.js";import{D as P}from"./DataSelector-f21db79c.js";import{g as h}from"./purchaseOrder-b04f9821.js";import{g as y}from"./warehouse-2c8e7b55.js";import{j as k,_ as v,r as d,o as x,c as D,a as e,w as o,d as u,e as p,t as I}from"./index-402981fb.js";function S(s){return k({method:"POST",url:"/rms/receiving",data:s})}const U={components:{BgContainer:O,DataSelector:P},data(){return{dialogVisible:!1,purchaseOrders:[],warehouseData:[],selectedPurchaseOrder:{},selectedWarehouseId:0,remark:""}},methods:{selectPurchaseOrder(s){this.dialogVisible=!0,this.selectedPurchaseOrder=s},handleReceiptSubmit(s){S({purchaseOrderId:s,warehouseId:this.selectedWarehouseId,remark:this.remark,userUUID:"",items:[],type:0}).then(()=>{this.dialogVisible=!1,h({status:1}).then(l=>this.purchaseOrders=l.data.data)})}},created(){h({status:1}).then(s=>this.purchaseOrders=s.data.data),y().then(s=>this.warehouseData=s.data.data)}},w={class:"container"},C=u("div",{class:"header"},[u("h2",null,"采购入库")],-1),N=u("h3",null,"采购订单列表",-1),B=u("h3",null,"采购订单明细",-1),W={class:"dialog-footer"};function R(s,l,T,j,t,m){const a=d("el-table-column"),c=d("el-button"),_=d("el-table"),f=d("el-card"),i=d("el-input"),n=d("el-form-item"),b=d("DataSelector"),V=d("el-form"),g=d("el-dialog");return x(),D("div",w,[C,e(f,null,{default:o(()=>[N,e(_,{data:t.purchaseOrders,border:"",stripe:""},{default:o(()=>[e(a,{prop:"id",label:"采购订单编号"}),e(a,{prop:"supplierId",label:"供应商id"}),e(a,{prop:"supplierName",label:"供应商名"}),e(a,{prop:"orderDate",label:"下单时间"}),e(a,{prop:"status",label:"状态"}),e(a,{label:"操作"},{default:o(({row:r})=>[e(c,{size:"small",type:"primary",onClick:z=>m.selectPurchaseOrder(r)},{default:o(()=>[p("选择")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),e(g,{modelValue:t.dialogVisible,"onUpdate:modelValue":l[7]||(l[7]=r=>t.dialogVisible=r),width:"50%","align-center":""},{footer:o(()=>[u("span",W,[e(c,{onClick:l[5]||(l[5]=r=>t.dialogVisible=!1)},{default:o(()=>[p("取消")]),_:1}),e(c,{type:"primary",onClick:l[6]||(l[6]=r=>m.handleReceiptSubmit(t.selectedPurchaseOrder.id))},{default:o(()=>[p(" 确认入库 ")]),_:1})])]),default:o(()=>[B,e(V,{model:t.selectedPurchaseOrder,ref:"form","label-width":"120px","label-position":"top"},{default:o(()=>[e(n,{label:"订单编号"},{default:o(()=>[e(i,{modelValue:t.selectedPurchaseOrder.id,"onUpdate:modelValue":l[0]||(l[0]=r=>t.selectedPurchaseOrder.id=r),readonly:""},null,8,["modelValue"])]),_:1}),e(n,{label:"供应商名"},{default:o(()=>[e(i,{modelValue:t.selectedPurchaseOrder.supplierName,"onUpdate:modelValue":l[1]||(l[1]=r=>t.selectedPurchaseOrder.supplierName=r),readonly:""},null,8,["modelValue"])]),_:1}),e(n,{label:"状态"},{default:o(()=>[e(i,{modelValue:t.selectedPurchaseOrder.status,"onUpdate:modelValue":l[2]||(l[2]=r=>t.selectedPurchaseOrder.status=r),readonly:""},null,8,["modelValue"])]),_:1}),e(n,{label:"选择仓库"},{default:o(()=>[e(b,{selected:t.selectedWarehouseId,"onUpdate:selected":l[3]||(l[3]=r=>t.selectedWarehouseId=r),data:t.warehouseData,placeholder:"请选择或搜索仓库"},null,8,["selected","data"])]),_:1}),e(n,{label:"备注"},{default:o(()=>[e(i,{modelValue:t.remark,"onUpdate:modelValue":l[4]||(l[4]=r=>t.remark=r),max:255},null,8,["modelValue"])]),_:1}),e(n,{label:"货物列表"},{default:o(()=>[e(_,{data:t.selectedPurchaseOrder.items,border:"",stripe:"","max-height":"400"},{default:o(()=>[e(a,{prop:"productId",label:"货物编号"}),e(a,{prop:"productName",label:"货物名称"}),e(a,{prop:"count",label:"数量"}),e(a,{prop:"unitPrice",label:"单价"}),e(a,{prop:"subtotal",label:"小计"},{default:o(({row:r})=>[p(I((r.count*r.unitPrice).toFixed(2)),1)]),_:1})]),_:1},8,["data"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}const H=v(U,[["render",R]]);export{H as default};
